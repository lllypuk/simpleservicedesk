# Domain Storage Repositories - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–ª—è –≤—Å–µ—Ö –¥–æ–º–µ–Ω–Ω—ã—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π

## üéØ –û–ø–∏—Å–∞–Ω–∏–µ —Ñ–∏—á–∏

### –ü—Ä–æ–±–ª–µ–º–∞

–í –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è –≤ —Å–∏—Å—Ç–µ–º–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —Ç–æ–ª—å–∫–æ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (Users), –Ω–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –∏ —Å–ª–æ–∏
—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –∫–ª—é—á–µ–≤—ã—Ö –¥–æ–º–µ–Ω–Ω—ã—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π:

- **Tickets**: –ó–∞—è–≤–∫–∏ –≤ —Å–ª—É–∂–±—É –ø–æ–¥–¥–µ—Ä–∂–∫–∏ - –æ—Å–Ω–æ–≤–Ω–∞—è —Å—É—â–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã
- **Categories**: –°–∏—Å—Ç–µ–º–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏–∏ –∑–∞—è–≤–æ–∫ –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
- **Organizations**: –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–æ–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∑–∞—è–≤–æ–∫

–ë–µ–∑ —ç—Ç–∏—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ:

- –°–æ–∑–¥–∞–≤–∞—Ç—å –∏ —É–ø—Ä–∞–≤–ª—è—Ç—å –∑–∞—è–≤–∫–∞–º–∏
- –û—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è–º
- –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å business logic

### –†–µ—à–µ–Ω–∏–µ

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–ª–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ —Å–ª–µ–¥—É—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É –ø–∞—Ç—Ç–µ—Ä–Ω—É:

- **–ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ç–µ—Ö –∂–µ –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤, —á—Ç–æ –∏ –≤ UserRepository
- **MongoDB**: –û—Å–Ω–æ–≤–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ MongoDB
- **–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ—Å—Ç—å**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ ACID –æ–ø–µ—Ä–∞—Ü–∏–π –≥–¥–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ
- **–¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å**: –ü–æ–ª–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ unit –∏ integration —Ç–µ—Å—Ç–∞–º–∏

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- [ ] **FR-1**: TicketRepository —Å CRUD –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏ –∏ –ø–æ–∏—Å–∫–æ–º –ø–æ —Å—Ç–∞—Ç—É—Å—É/–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É
- [ ] **FR-2**: CategoryRepository —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã (parent-child)
- [ ] **FR-3**: OrganizationRepository —Å –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π
- [ ] **FR-4**: –°–≤—è–∑–∏ –º–µ–∂–¥—É —Å—É—â–Ω–æ—Å—Ç—è–º–∏ (Ticket-User, Ticket-Category, User-Organization)
- [ ] **FR-5**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –¥–ª—è –≤—Å–µ—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
- [ ] **FR-6**: Batch –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –∑–∞–ø–∏—Å—è–º–∏

### –ù–µ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- [ ] **NFR-1**: –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–≤—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ < 200ms –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤)
- [ ] **NFR-2**: –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å (–ø–æ–¥–¥–µ—Ä–∂–∫–∞ 10K+ –∑–∞–ø–∏—Å–µ–π –≤ –∫–∞–∂–¥–æ–π –∫–æ–ª–ª–µ–∫—Ü–∏–∏)
- [ ] **NFR-3**: –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (–≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —É—Ä–æ–≤–Ω–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤)
- [ ] **NFR-4**: –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å (graceful handling MongoDB connection issues)
- [ ] **NFR-5**: –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å (–µ–¥–∏–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è MongoDB —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏)

## üèóÔ∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

- **Application Layer**: `internal/application/interfaces.go` - –Ω–æ–≤—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
- **Infrastructure Layer**:
    - `internal/infrastructure/tickets/` - MongoDB —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
    - `internal/infrastructure/categories/` - MongoDB —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
    - `internal/infrastructure/organizations/` - MongoDB —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
- **Testing**: –ú–æ–∫–∏ –¥–ª—è –≤—Å–µ—Ö –Ω–æ–≤—ã—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ –≤ `internal/application/mocks/`

### –ù–æ–≤—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤

```go
// TicketRepository - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–∞–º–∏
type TicketRepository interface {
CreateTicket(ctx context.Context, createFn func () (*tickets.Ticket, error)) (*tickets.Ticket, error)
UpdateTicket(ctx context.Context, id uuid.UUID, updateFn func (*tickets.Ticket) (bool, error)) (*tickets.Ticket, error)
GetTicket(ctx context.Context, id uuid.UUID) (*tickets.Ticket, error)
ListTickets(ctx context.Context, filter TicketFilter) ([]*tickets.Ticket, error)
DeleteTicket(ctx context.Context, id uuid.UUID) error
}

// CategoryRepository - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
type CategoryRepository interface {
CreateCategory(ctx context.Context, createFn func () (*categories.Category, error)) (*categories.Category, error)
UpdateCategory(ctx context.Context, id uuid.UUID, updateFn func (*categories.Category) (bool, error)) (*categories.Category, error)
GetCategory(ctx context.Context, id uuid.UUID) (*categories.Category, error)
ListCategories(ctx context.Context, filter CategoryFilter) ([]*categories.Category, error)
GetCategoryHierarchy(ctx context.Context, rootID uuid.UUID) (*categories.CategoryTree, error)
DeleteCategory(ctx context.Context, id uuid.UUID) error
}

// OrganizationRepository - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è–º–∏
type OrganizationRepository interface {
CreateOrganization(ctx context.Context, createFn func () (*organizations.Organization, error)) (*organizations.Organization, error)
UpdateOrganization(ctx context.Context, id uuid.UUID, updateFn func (*organizations.Organization) (bool, error)) (*organizations.Organization, error)
GetOrganization(ctx context.Context, id uuid.UUID) (*organizations.Organization, error)
ListOrganizations(ctx context.Context, filter OrganizationFilter) ([]*organizations.Organization, error)
GetOrganizationHierarchy(ctx context.Context, rootID uuid.UUID) (*organizations.OrganizationTree, error)
DeleteOrganization(ctx context.Context, id uuid.UUID) error
}
```

### MongoDB –∫–æ–ª–ª–µ–∫—Ü–∏–∏

- **tickets**: –û—Å–Ω–æ–≤–Ω–∞—è –∫–æ–ª–ª–µ–∫—Ü–∏—è –∑–∞—è–≤–æ–∫
- **categories**: –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å parent_id –¥–ª—è –∏–µ—Ä–∞—Ä—Ö–∏–∏
- **organizations**: –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ —Å parent_id –¥–ª—è –∏–µ—Ä–∞—Ä—Ö–∏–∏

### –ù–æ–≤—ã–µ –∏–Ω–¥–µ–∫—Å—ã

```javascript
// tickets collection
db.tickets.createIndex({"status": 1})
db.tickets.createIndex({"priority": 1})
db.tickets.createIndex({"assigned_to": 1})
db.tickets.createIndex({"category_id": 1})
db.tickets.createIndex({"created_at": -1})

// categories collection
db.categories.createIndex({"parent_id": 1})
db.categories.createIndex({"name": 1}, {unique: true})

// organizations collection  
db.organizations.createIndex({"parent_id": 1})
db.organizations.createIndex({"name": 1}, {unique: true})
```

## üîÑ User Stories

### –ò—Å—Ç–æ—Ä–∏—è 1: Agent —Ö–æ—á–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –∑–∞—è–≤–∫–∞–º–∏

**–ö–∞–∫** –∞–≥–µ–Ω—Ç —Å–ª—É–∂–±—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏  
**–Ø —Ö–æ—á—É** —Å–æ–∑–¥–∞–≤–∞—Ç—å, –æ–±–Ω–æ–≤–ª—è—Ç—å –∏ –∏—Å–∫–∞—Ç—å –∑–∞—è–≤–∫–∏  
**–ß—Ç–æ–±—ã** —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏:**

- [ ] Given –≤–∞–ª–∏–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∑–∞—è–≤–∫–∏, when —Å–æ–∑–¥–∞—é –∑–∞—è–≤–∫—É, then –∑–∞—è–≤–∫–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º ID
- [ ] Given —Å—É—â–µ—Å—Ç–≤—É—é—â–∞—è –∑–∞—è–≤–∫–∞, when –æ–±–Ω–æ–≤–ª—è—é —Å—Ç–∞—Ç—É—Å, then —Å—Ç–∞—Ç—É—Å –∏–∑–º–µ–Ω—è–µ—Ç—Å—è —Å–æ–≥–ª–∞—Å–Ω–æ business rules
- [ ] Given –∫—Ä–∏—Ç–µ—Ä–∏–∏ –ø–æ–∏—Å–∫–∞, when –∏—â—É –∑–∞—è–≤–∫–∏, then –ø–æ–ª—É—á–∞—é –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫

### –ò—Å—Ç–æ—Ä–∏—è 2: Admin —Ö–æ—á–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏

**–ö–∞–∫** –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —Å–∏—Å—Ç–µ–º—ã  
**–Ø —Ö–æ—á—É** —Å–æ–∑–¥–∞–≤–∞—Ç—å –∏–µ—Ä–∞—Ä—Ö–∏—é –∫–∞—Ç–µ–≥–æ—Ä–∏–π  
**–ß—Ç–æ–±—ã** –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—é –∑–∞—è–≤–æ–∫

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏:**

- [ ] Given —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é, when —Å–æ–∑–¥–∞—é –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—é, then —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è parent-child —Å–≤—è–∑—å
- [ ] Given –∫–∞—Ç–µ–≥–æ—Ä–∏—é —Å –ø–æ–¥–∫ategor–∏—è–º–∏, when –ø–æ–ª—É—á–∞—é –∏–µ—Ä–∞—Ä—Ö–∏—é, then –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –ø–æ–ª–Ω–æ–µ –¥–µ—Ä–µ–≤–æ
- [ ] Given –∫–∞—Ç–µ–≥–æ—Ä–∏—é —Å –∑–∞—è–≤–∫–∞–º–∏, when –ø—ã—Ç–∞—é—Å—å —É–¥–∞–ª–∏—Ç—å, then –æ–ø–µ—Ä–∞—Ü–∏—è –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è

### –ò—Å—Ç–æ—Ä–∏—è 3: Admin —Ö–æ—á–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–æ–Ω–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π

**–ö–∞–∫** –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —Å–∏—Å—Ç–µ–º—ã  
**–Ø —Ö–æ—á—É** —Å–æ–∑–¥–∞–≤–∞—Ç—å –∏–µ—Ä–∞—Ä—Ö–∏—é –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π  
**–ß—Ç–æ–±—ã** –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏:**

- [ ] Given –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é, when —Å–æ–∑–¥–∞—é –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ, then —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∞—è —Å–≤—è–∑—å
- [ ] Given –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é, when –ø–æ–ª—É—á–∞—é –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, then –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤—Å–µ—Ö –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–π
- [ ] Given –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏, when –ø—ã—Ç–∞—é—Å—å —É–¥–∞–ª–∏—Ç—å, then –æ–ø–µ—Ä–∞—Ü–∏—è –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è

## üß™ –ü–ª–∞–Ω —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### Unit Tests

- [ ] **Domain logic**: –í–∞–ª–∏–¥–∞—Ü–∏—è –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª –¥–ª—è –∫–∞–∂–¥–æ–π —Å—É—â–Ω–æ—Å—Ç–∏
- [ ] **Repository methods**: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ CRUD –æ–ø–µ—Ä–∞—Ü–∏–π —Å –º–æ–∫–∞–º–∏
- [ ] **Filter logic**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
- [ ] **Error handling**: –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö –≤–æ–∑–º–æ–∂–Ω—ã—Ö –æ—à–∏–±–æ—á–Ω—ã—Ö —Å–∏—Ç—É–∞—Ü–∏–π

### Integration Tests

- [ ] **MongoDB repositories**: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Ä–µ–∞–ª—å–Ω–æ–π –ë–î —á–µ—Ä–µ–∑ testcontainers
- [ ] **Cross-repository operations**: –û–ø–µ—Ä–∞—Ü–∏–∏ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—é—â–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
- [ ] **Transaction handling**: –ü—Ä–æ–≤–µ—Ä–∫–∞ ACID —Å–≤–æ–π—Å—Ç–≤ –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- [ ] **Performance**: Load testing –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

### Test Coverage Goals

- **Unit tests**: > 90% –¥–ª—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
- **Integration tests**: 100% –ø–æ–∫—Ä—ã—Ç–∏–µ API endpoints
- **Error scenarios**: –í—Å–µ error paths –ø–æ–∫—Ä—ã—Ç—ã —Ç–µ—Å—Ç–∞–º–∏

## üìä –ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏

- [ ] Repository method response time < 200ms (95th percentile)
- [ ] Error rate < 0.5% –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- [ ] Test coverage > 85% –¥–ª—è –Ω–æ–≤–æ–≥–æ –∫–æ–¥–∞
- [ ] Zero memory leaks –≤ integration tests

### –ü—Ä–æ–¥—É–∫—Ç–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏

- [ ] –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞–≤–∞—Ç—å 1000+ –∑–∞—è–≤–æ–∫ –±–µ–∑ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏–µ—Ä–∞—Ä—Ö–∏–π –¥–æ 10 —É—Ä–æ–≤–Ω–µ–π –≥–ª—É–±–∏–Ω–æ–π
- [ ] Concurrent operations –±–µ–∑ data corruption

## üöÄ –ü–ª–∞–Ω –≤–Ω–µ–¥—Ä–µ–Ω–∏—è

### Phase 1: TicketRepository (Priority: High)

**–°—Ä–æ–∫**: 3-5 –¥–Ω–µ–π

- [ ] –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å TicketRepository –≤ interfaces.go
- [ ] MongoDB —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å –æ—Å–Ω–æ–≤–Ω—ã–º–∏ CRUD –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏
- [ ] Unit tests –¥–ª—è domain logic
- [ ] Integration tests —Å MongoDB
- [ ] Mock –¥–ª—è TicketRepository

### Phase 2: CategoryRepository (Priority: Medium)

**–°—Ä–æ–∫**: 2-3 –¥–Ω—è

- [ ] –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å CategoryRepository —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∏–µ—Ä–∞—Ä—Ö–∏–π
- [ ] MongoDB —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏
- [ ] –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- [ ] Mock –¥–ª—è CategoryRepository

### Phase 3: OrganizationRepository (Priority: Medium)

**–°—Ä–æ–∫**: 2-3 –¥–Ω—è

- [ ] –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å OrganizationRepository
- [ ] MongoDB —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–π –ª–æ–≥–∏–∫–æ–π
- [ ] –¢–µ—Å—Ç—ã –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–æ–Ω–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- [ ] Mock –¥–ª—è OrganizationRepository

### Phase 4: Integration & Optimization (Priority: Low)

**–°—Ä–æ–∫**: 2-3 –¥–Ω—è

- [ ] Cross-repository –æ–ø–µ—Ä–∞—Ü–∏–∏
- [ ] Performance optimizations
- [ ] Advanced filtering capabilities
- [ ] Comprehensive error handling
- [ ] Documentation updates

### Definition of Done –¥–ª—è –∫–∞–∂–¥–æ–π —Ñ–∞–∑—ã

- [ ] –ö–æ–¥ —Å–ª–µ–¥—É–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º conventions (English comments, clean architecture)
- [ ] `make lint` –ø—Ä–æ—Ö–æ–¥–∏—Ç –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] `make test` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç > 85% coverage –¥–ª—è –Ω–æ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- [ ] Integration tests —Å MongoDB –ø—Ä–æ—Ö–æ–¥—è—Ç
- [ ] –ú–æ–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ —Ç–µ—Å—Ç–∞—Ö
- [ ] –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ interfaces.go
- [ ] Performance requirements –≤—ã–ø–æ–ª–Ω–µ–Ω—ã

## üîó –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### –í–Ω–µ—à–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- **MongoDB Driver**: –£–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è UserRepository
- **Testcontainers**: –£–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è integration testing
- **UUID library**: github.com/google/uuid —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

### –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- **Domain models**: –í—Å–µ domain entities —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã
- **Existing patterns**: –°–ª–µ–¥–æ–≤–∞–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º –∏–∑ UserRepository
- **Mock generation**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ –∫ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –º–æ–∫–æ–≤

## ‚ö†Ô∏è –†–∏—Å–∫–∏ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–∏—Å–∫–∏

- **Performance impact**: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤ –º–æ–∂–µ—Ç –∑–∞–º–µ–¥–ª–∏—Ç—å write operations
- **Concurrent access**: Race conditions –ø—Ä–∏ concurrent updates

### –ú–∏—Ç–∏–≥–∞—Ü–∏—è —Ä–∏—Å–∫–æ–≤

- **Batch operations**: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è batch –º–µ—Ç–æ–¥–æ–≤ –¥–ª—è bulk operations
- **Connection pooling**: –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ MongoDB connection pool
- **Optimistic locking**: –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è data corruption
- **Graceful degradation**: Fallback –º–µ—Ö–∞–Ω–∏–∑–º—ã –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ MongoDB

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

- **Hierarchy depth**: –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã —Ä–∞–∑—É–º–Ω–æ–π –≥–ª—É–±–∏–Ω–æ–π (10 —É—Ä–æ–≤–Ω–µ–π)
- **Batch size**: Batch operations –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã —Ä–∞–∑—É–º–Ω—ã–º —Ä–∞–∑–º–µ—Ä–æ–º (1000 records)

## üìù –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏

### Open Questions

- [ ] –ù—É–∂–Ω–∞ –ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ soft delete –¥–ª—è –≤—Å–µ—Ö entities?
- [ ] –¢—Ä–µ–±—É–µ—Ç—Å—è –ª–∏ audit log –¥–ª—è tracking –∏–∑–º–µ–Ω–µ–Ω–∏–π?
- [ ] –ù—É–∂–Ω—ã –ª–∏ full-text search capabilities –¥–ª—è tickets?

### Future Considerations

- **Caching layer**: Redis –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —á–∞—Å—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **Event sourcing**: –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ event-driven –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É
- **Sharding**: Horizontal scaling —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –¥–ª—è –±–æ–ª—å—à–∏—Ö datasets
- **Search engine**: Integration —Å Elasticsearch –¥–ª—è advanced search

### Implementation Notes

- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø–∞—Ç—Ç–µ—Ä–Ω —Å `createFn` –∏ `updateFn` –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è consistency
- –ü—Ä–∏–º–µ–Ω—è—Ç—å —Ç–æ—Ç –∂–µ –ø–æ–¥—Ö–æ–¥ –∫ error handling —á—Ç–æ –∏ –≤ UserRepository
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏–µ –≤ naming conventions –∏ code structure
- –í—Å–µ MongoDB –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥ –∫ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏

---

> üí° **–í–∞–∂–Ω–æ**: –≠—Ç–∞ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ—ç—Ç–∞–ø–Ω–æ, —Å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ–º `make lint` –∏ `make test`
> –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞. –ö–∞–∂–¥—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ—Ö–æ–¥–æ–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É.